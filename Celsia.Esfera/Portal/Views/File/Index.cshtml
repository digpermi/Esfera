@model Portal.ViewModels.FileViewModel

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";

    int countErrors = 0;
    int countSuccess = 0;
}

<h3 class="mt-4 font-weight-semibold mb-0 ml-3 mr-3">Carga Masiva</h3>
<p class="ml-3 mr-3 mb-4">Esta opción permite hacer la carga masiva de personas vinculadas a un cliente.</p>
<hr>

<message user-message="@Model.UserMesage"></message>

<h6 class="mt-4 text-orange font-weight-semibold ml-3 mr-3">Archivo</h6>

<form asp-action="Index" asp-controller="File" method="post" enctype="multipart/form-data">
    <div class="row ml-1 mr-1 mt-4">
        <div class="col-xl-6 col-md-6">
            <div class="form-group">
                <label class="small mb-1">Formato CSV</label>
                <input name="UploadFile" asp-for="UploadFile" class="form-control" type="file">
                <span asp-validation-for="UploadFile" class="label label-danger"></span>
            </div>
        </div>
        <div class="col-xl-3 col-md-3">
            <button class="btn btn-secondary btn-block" type="submit">Cargar</button>
        </div>
        <div class="col-xl-3 col-md-3">
        </div>
    </div>
</form>

@if (Model.Messages != null)
{
    <hr>
    <h6 class="mt-4 text-orange font-weight-semibold ml-3 mr-3">Log</h6>
    <div class="row ml-1 mr-1 mt-4 pt-2">
        <div class="col-xl-12 col-md-12 divLogs">
            @foreach (var message in Model.Messages)
            {
                if (message.Type.ToString() == "Ok")
                {
                    countSuccess++;
                    <p class="label label-success">- @message.Text</p>
                }
                else
                {
                    countErrors++;
                    <p class="label label-danger">- @message.Text</p>
                }
            }
            <br />
            <strong>Personas cargadas: @countSuccess</strong><br />
            <strong>Personas con errores: @countErrors</strong><br />
            <strong>Total filas procesadas: @Model.TotalRows</strong><br />
        </div>
    </div>
}


